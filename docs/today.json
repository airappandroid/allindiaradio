<script>
document.addEventListener("DOMContentLoaded", function(){

  const list = document.getElementById("todayList");

  /* STEP A: CHECK HTML EXISTS */
  if(!list){
    alert("todayList div NOT found");
    return;
  }

  /* STEP B: SHOW LOADING */
  list.innerHTML = "<div class='today-item'>Loading schedule...</div>";

  /* STEP C: FETCH JSON */
  fetch("https://airappandroid.github.io/allindiaradio/today.json")
    .then(res => {
      if(!res.ok) throw new Error("JSON not reachable");
      return res.json();
    })
    .then(data => {

      /* STEP D: CHECK JSON */
      if(!data.schedule){
        list.innerHTML = "<div class='today-item'>Schedule key missing</div>";
        return;
      }

      /* STEP E: RENDER FIRST 3 (NO TIME LOGIC) */
      list.innerHTML = "";

      data.schedule.slice(0,3).forEach(item=>{
        list.innerHTML += `
          <div class="today-item">
            <div class="today-time">${item.time}</div>
            <div>
              <span class="program">${item.program}</span>
              <span class="channel"> â€“ ${item.channel}</span>
            </div>
          </div>
        `;
      });

    })
    .catch(err=>{
      list.innerHTML = "<div class='today-item'>ERROR loading JSON</div>";
    });

});
</script>
